import numpy as np

class simuConfig:
    rndSeed = 2017
    trsMaxCCTask = 2
    realSchedule = True
    simTime  = 3600 * 24 * 3                   # total simulation time in second
    warmTime = 3600 * 2                          # warmup time
    gracePeriod = 3600 * 24                      # a period to process tail jobs
    minBW = 125.                                 # the minimum bandwidth to consider, i.e., job will not consider to 
                                                 # use a path if its free bandwidth is less than this para. value
    maxE2EPath  = 5                              # maximum number of end-to-end path 
    ds_ratio    = 1.0                            # ratio of datasize after upgrading
    net_ratio   = 0.20                           # percentage of network dedicated to the superfacility
    net_max_resv = 1.0                           # if the current available bandwidth is X, we will only reserve 0.5 * X  
    rescheduleEAJ = False

    expSiteName  = ('APS', 'ALS', 'SSRL', 'LCLS', 'NSLS')
    compSiteName = ('ANL', 'NERSC', 'ORNL') #+ ('APS-C', 'ALS-C', 'SSRL-C', 'LCLS-C', 'NSLS-C')
    total_compr  = int(3 * 688 * 1.43)
    edge, scenter = int(0.05 * total_compr), int(total_compr * 0.75 / 3.)
    # compSiteNodes= {'ANL':scenter, 'NERSC':scenter, 'ORNL':scenter, \
    #                 'APS-C':edge, 'ALS-C':edge, 'SSRL-C':edge, 'LCLS-C':edge, 'NSLS-C':edge}
    compSiteNodes= {'ANL':np.round(total_compr/3.), 'NERSC':np.round(total_compr/3.), 'ORNL':np.round(total_compr/3.)}
    compSiteNodes= {'ANL':0, 'NERSC':0, 'ORNL':total_compr}

    beamlineCfg  = {"APS":
                        [((6e3, 11e3), (1, 60), (0, 3600)), ((8e3, 21e3), (10, 300), (0, 3600)), \
                        ((6e3, 11e3), (600, 1800), (300, 300)), ((2e3, 8e3), (900, 3600), (900, 3600)),\
                        ((2e3, 20e3), (60, 600), (120, 600)), ((2e3, 30e3), (60, 300), (120, 300)), \
                        ((1e3, 11e3), (600, 3600), (1800, 3600)), ((100, 50e3), (600, 24*3600), (60, 3600)),\
                        ((100, 50e3), (600, 24*3600), (60, 3600)), ((100, 50e3), (600, 24*3600), (60, 3600)),\
                        ((100, 10e3), (600, 24*3600), (60, 3600)), ((100, 10e3), (600, 24*3600), (60, 3600))],
                    "ALS":
                        [((1509.949, 1509.949), (3600, 3600), (18, 18)), ((5662.310, 5662.310), (3600, 3600), (300, 300)),
                        ((81854.640, 81854.640), (7200, 7200), (10000, 10000)), ((29948.400, 29948.400), (72000, 72000), (180, 180)),
                        ((3769.960, 3769.960), (3600, 3600), (100, 100)), ((3769.960, 3769.960), (3600, 3600), (100, 100)),
                        ((3769.960, 3769.960), (3600, 3600), (100, 100)), ((384160.000, 384160.000), (3600, 3600), (50000, 50000)),
                        ((13107.200, 13107.200), (7200, 7200), (2500, 2500)), ((11887.320, 11887.320), (7200, 7200), (120, 120)),
                        ((3769.960, 3769.960), (3600, 3600), (100, 100)), ((3769.960, 3769.960), (3600, 3600), (100, 100)),
                        ((3769.960, 3769.960), (3600, 3600), (100, 100)), ((22660.301, 22660.301), (3600, 3600), (512, 512))],
                    "NSLS":
                        [((1e3, 11e3), (600, 3600), (1800, 3600)), ((100, 50e3), (600, 24*3600), (60, 3600)),
                        ((6e3, 11e3), (1, 60), (0, 3600)), ((8e3, 21e3), (10, 300), (0, 3600)), \
                        ((6e3, 11e3), (600, 1800), (300, 300)), ((2e3, 8e3), (900, 3600), (900, 3600))],
                    "SSRL":
                        [((1e3, 11e3), (600, 3600), (1800, 3600)), ((100, 50e3), (600, 24*3600), (60, 3600)),
                        ((6e3, 11e3), (1, 60), (0, 3600)), ((8e3, 21e3), (10, 300), (0, 3600)), \
                        ((6e3, 11e3), (600, 1800), (300, 300)), ((2e3, 8e3), (900, 3600), (900, 3600))],
                    # "SSRL":[((1e3, 100e3), (60, 300), (300, 3600)), ((10e3, 400e3), (40, 60), (90, 1800)),
                    #         ((20e3, 22e3), (30, 60), (300, 420))],
                    "LCLS":
                        [((8e5, 1e6), (0, 3600), (900, 900)), ((8e5, 1e6), (0, 3600), (900, 900)), \
                         ((8e5, 1e6), (0, 3600), (900, 900)), ((8e5, 1e6), (0, 3600), (900, 900)), \
                         ((8e5, 1e6), (0, 3600), (900, 900)), ((8e5, 1e6), (0, 3600), (900, 900)), \
                         ((8e5, 1e6), (0, 3600), (900, 900))]
                    }
    # original operating schedule
    # expSiteSchedule= {"APS": 
    #                     [24*30+8, 24*6, 24, 24*6, 24, 24*6, 24, 24*6, 48, 24*5, 24, 24*6, 24, 24*6, 24, 24*6, 24, 24*6, 24, 24*6, \
    #                     24, 24*6, 24, 24*6+16, 24*36+8, 24*5, 24, 24*6, 24, 24*6, 24, 24*6, 48, 24*6, 24, 24*5, 24, 24*6, 24, \
    #                     24*6, 24, 24*6, 24, 24*6, 24, 24*6, 24, 24*7+16, 24*42+8, 24*6, 24, 24*6, 24, 24*6, 24, 24*6, 48, 24*5, \
    #                     24, 24*6, 24, 24*7, 48, 24*10, 24, 24*6, 24, 24*6, 24*13+16],
    #                   "ALS":
    #                     [24*78+8, 24*6+16, 24*2+8, 24*5, 24*1, 24*1+16, 24*1, 24*2+8, 24*3, 24*5, 24*1, 24*5+16, 24*2+8, 24*5,\
    #                     24*1, 24*5, 24*3, 24*5, 24*1, 24*5+16, 24*2+8, 24*4+16, 24*2+8, 24*4, 24*3, 24*5, 24*1, 24*5+16,\
    #                     24*23+8, 24*5, 24*1, 24*5, 24*3, 24*5, 24*1, 24*5+16, 24*2+8, 24*5, 24*1, 24*5, 24*2, 24*6, 24*10,\
    #                     24*4, 24*1, 24*4+16, 24*3+8, 24*5, 24*1, 24*5+16, 24*2+8, 24*5, 24*1, 24*5, 24*3, 24*3, 24*3, 24*6,\
    #                     24*2, 24*5, 24*1, 24*5, 24*4, 24*6+8, 24*5+16, 24*6, 24*3, 24*4, 24*1, 24*6, 24*1, 24*2+16, 24*10],
    #                   "NSLS":
    #                     [24*8+12, 24*5+20, 24, 24*6, 24*4, 24*4+4, 20, 24*4, 24*2, 24*7, 24*3, 24*5+4, 20, 24*3, 24*2, 24*7, 24*3,\
    #                     24*5+4, 20, 24*3, 24*2, 24*7, 24*3, 24*5+4, 20, 24*3, 24*2, 24*4+4, 3*4+24*37+3*4, 24*8-4, 24*3+4, \
    #                     24*4, 20, 24*3, 24*2, 24*7, 24*3, 24*5+4, 20, 24*2+8, 24*4+20, 24*3-4, 24*2, 24*7, 24*3, 24*5+4, 20,\
    #                     24*3, 24*2, 28, 20, 24*5, 24*57, 24*5, 24*2, 24*7, 24*3, 24*5+4, 20, 24*3+4, 24*2-4, 24*7, 24*3, 24*5+4,\
    #                     20, 24*7+8, 24*4+16, 24*7, 24*27-8],
    #                   "SSRL":
    #                     [24*4+8, 24*4, 24*2, 24*19, 24*2, 24*12, 24*2, 24*12, 24*2, 24*12, 24*2, 24*12, 24*2, 24*12, 24*2, 24*12,\
    #                     24*9, 24*19, 24*2, 24*12, 24*2, 24*12, 24*2, 24*19, 24*2, 24*19, 24*77, 24*14, 24*2, 24*12, 24*2, \
    #                     16+24*6+16, 16+24, 24*3, 24*2, 24*6, 24*2, 24*13, 24*11+16],
    #                   "LCLS":
    #                     [24*14+9, 24*5, 24*1, 24*5, 24*3, 24*5, 24*1, 24*6, 24*2, 24*5, 24*1, 24*5, 24*3, 24*5, 24*1, 24*5,\
    #                     24*3, 24*5, 24*1, 24*5, 24*4, 24*5, 24*1, 24*5, 24*2, 24*5, 24*1, 24*5, 24*2, 24*5, 24*1, 24*6,\
    #                     24*3, 24*6, 24*1, 24*4, 24*2, 24*5, 24*3, 24*6, 24*1, 24*4, 24*2, 24*5, 24*2, 24*6, 24*2, 24*6, \
    #                     24*1, 24*6, 24*1, 24*5, 24*1, 24*15, 24*1, 24*5, 24*1, 24*5, 24*65, 24*5, 24*2, 24*5, 24*1, 24*6,\
    #                     24*2, 24*5, 24*3, 24*3, 24*2, 24*6, 24*1, 24*5, 24*2, 24*5, 24*1, 24*11, 24*12+15] #2015
    #                 }
    ## optimal, variance
    expSiteSchedule= {"APS": 
                        [0, 104, 24, 144, 24, 144, 24, 184, 1016, 144, 24, 144, 24, 144, 24, 144, 48, 120, 24, 144, 24, 168, 48, \
                        240, 24, 144, 24, 144, 1056, 144, 24, 144, 24, 144, 24, 144, 48, 120, 24, 144, 24, 144, 24, 144, 24, 144, \
                        24, 144, 24, 144, 24, 160, 872, 120, 24, 144, 24, 144, 24, 144, 48, 144, 24, 120, 24, 144, 24, 144, 24, 40],
                      "ALS":
                        [0, 8, 24, 136, 560, 120, 24, 120, 72, 120, 24, 136, 56, 120, 24, 120, 48, 144, 240, 96, 24, 112, 80, 120, \
                        24, 136, 56, 120, 24, 120, 72, 72, 72, 144, 48, 120, 24, 120, 96, 152, 136, 144, 72, 96, 24, 144, 24, 64, 2120, \
                        160, 56, 120, 24, 40, 24, 56, 72, 120, 24, 136, 56, 120, 24, 120, 72, 120, 24, 136, 56, 112, 56, 96, 72, 112],
                      "NSLS":
                        [204, 140, 24, 144, 96, 100, 20, 96, 48, 168, 72, 124, 20, 72, 48, 168, 72, 124, 20, 72, 48, 168, 72, 124,\
                        20, 72, 48, 100, 912, 188, 76, 96, 20, 72, 48, 168, 72, 124, 20, 56, 116, 68, 48, 168, 72, 124, 20, 72, 48,\
                        28, 20, 120, 1368, 120, 48, 168, 72, 124, 20, 76, 44, 168, 72, 124, 20, 176, 112, 168, 640],
                      "SSRL":
                        [8, 288, 48, 288, 48, 456, 48, 456, 1848, 336, 48, 288, 48, 176, 40, 72, 48, 144, 48, 312, 384, 96, 48, 456, \
                        48, 288, 48, 288, 48, 288, 48, 288, 48, 288, 48, 288, 216, 456, 40],
                      "LCLS":
                        [105, 120, 48, 120, 24, 144, 48, 120, 72, 72, 48, 144, 24, 120, 48, 120, 24, 264, 648, 120, 24, 120, 72, 120, \
                        24, 144, 48, 120, 24, 120, 72, 120, 24, 120, 72, 120, 24, 120, 96, 120, 24, 120, 48, 120, 24, 120, 48, 120, \
                        24, 144, 72, 144, 24, 96, 48, 120, 72, 144, 24, 96, 48, 120, 48, 144, 48, 144, 24, 144, 24, 120, 24, 360, 24, \
                        120, 24, 120, 1455] #2015
                    }
    ## optimal per-site shift
    # expSiteSchedule= {"APS": 
    #                     [0, 80, 24, 144, 24, 144, 24, 184, 1016, 144, 24, 144, 24, 144, 24, 144, 48, 120, 24, 144, 24, 168, 48, 240, \
    #                     24, 144, 24, 144, 1056, 144, 24, 144, 24, 144, 24, 144, 48, 120, 24, 144, 24, 144, 24, 144, 24, 144, 24, 144, \
    #                     24, 144, 24, 160, 872, 120, 24, 144, 24, 144, 24, 144, 48, 144, 24, 120, 24, 144, 24, 144, 24, 64],
    #                   "ALS":
    #                     [672, 160, 56, 120, 24, 40, 24, 56, 72, 120, 24, 136, 56, 120, 24, 120, 72, 120, 24, 136, 56, 112, 56, 96, 72, \
    #                     120, 24, 136, 560, 120, 24, 120, 72, 120, 24, 136, 56, 120, 24, 120, 48, 144, 240, 96, 24, 112, 80, 120, 24, 136, \
    #                     56, 120, 24, 120, 72, 72, 72, 144, 48, 120, 24, 120, 96, 152, 136, 144, 72, 96, 24, 144, 24, 64, 1448],
    #                   "NSLS":
    #                     [204, 140, 24, 144, 96, 100, 20, 96, 48, 168, 72, 124, 20, 72, 48, 168, 72, 124, 20, 72, 48, 168, 72, 124,\
    #                     20, 72, 48, 100, 912, 188, 76, 96, 20, 72, 48, 168, 72, 124, 20, 56, 116, 68, 48, 168, 72, 124, 20, 72, 48,\
    #                     28, 20, 120, 1368, 120, 48, 168, 72, 124, 20, 76, 44, 168, 72, 124, 20, 176, 112, 168, 640],
    #                   "SSRL":
    #                     [0, 296, 48, 288, 48, 288, 48, 288, 48, 288, 48, 288, 48, 288, 216, 456, 48, 288, 48, 288, 48, 456, 48, 456, \
    #                     1848, 336, 48, 288, 48, 176, 40, 72, 48, 144, 48, 312, 384, 96, 48, 160],
    #                   "LCLS":
    #                     [0, 9, 48, 144, 48, 144, 24, 144, 24, 120, 24, 360, 24, 120, 24, 120, 1560, 120, 48, 120, 24, 144, 48, 120, \
    #                     72, 72, 48, 144, 24, 120, 48, 120, 24, 264, 648, 120, 24, 120, 72, 120, 24, 144, 48, 120, 24, 120, 72, 120, \
    #                     24, 120, 72, 120, 24, 120, 96, 120, 24, 120, 48, 120, 24, 120, 48, 120, 24, 144, 72, 144, 24, 96, 48, 120, \
    #                     72, 144, 24, 96, 48, 111] #2015
    #                 }
    ## daily shift, minimize max
    # expSiteSchedule= {"NSLS": 
    #                     [204, 140, 24, 144, 96, 100, 20, 96, 48, 168, 72, 124, 20, 72, 48, 168, 72, 124, 20, 72, 48, 168, 72, 124, 20, \
    #                     72, 48, 100, 912, 188, 76, 96, 20, 72, 48, 168, 72, 124, 20, 56, 116, 68, 48, 168, 72, 124, 20, 72, 48, 28, 20, \
    #                     120, 1368, 120, 48, 168, 72, 124, 20, 76, 44, 168, 72, 124, 20, 176, 112, 168, 640],
    #                   "APS":
    #                     [0, 128, 24, 144, 24, 144, 24, 184, 1016, 144, 24, 144, 24, 144, 24, 144, 48, 120, 24, 144, 24, 168, 48, 240, 24, \
    #                     144, 24, 144, 1056, 144, 24, 144, 24, 144, 24, 144, 48, 120, 24, 144, 24, 144, 24, 144, 24, 144, 24, 144, 24, 144, \
    #                     24, 160, 872, 120, 24, 144, 24, 144, 24, 144, 48, 144, 24, 120, 24, 144, 24, 144, 24, 16],
    #                   "SSRL":
    #                     [0, 344, 48, 288, 48, 288, 48, 288, 48, 288, 48, 288, 48, 288, 216, 456, 48, 288, 48, 288, 48, 456, 48, 456, 1848, \
    #                     336, 48, 288, 48, 176, 40, 72, 48, 144, 48, 312, 384, 96, 48, 112],
    #                   "LCLS":
    #                     [0, 57, 48, 144, 48, 144, 24, 144, 24, 120, 24, 360, 24, 120, 24, 120, 1560, 120, 48, 120, 24, 144, 48, 120, 72, 72, \
    #                     48, 144, 24, 120, 48, 120, 24, 264, 648, 120, 24, 120, 72, 120, 24, 144, 48, 120, 24, 120, 72, 120, 24, 120, 72, 120, \
    #                     24, 120, 96, 120, 24, 120, 48, 120, 24, 120, 48, 120, 24, 144, 72, 144, 24, 96, 48, 120, 72, 144, 24, 96, 48, 63], #2015
    #                   "ALS":
    #                     [752, 160, 56, 120, 24, 40, 24, 56, 72, 120, 24, 136, 56, 120, 24, 120, 72, 120, 24, 136, 56, 112, 56, 96, 72, 120, \
    #                     24, 136, 560, 120, 24, 120, 72, 120, 24, 136, 56, 120, 24, 120, 48, 144, 240, 96, 24, 112, 80, 120, 24, 136, 56, 120, \
    #                     24, 120, 72, 72, 72, 144, 48, 120, 24, 120, 96, 152, 136, 144, 72, 96, 24, 144, 24, 64, 1368] 
    #                 }

    beamlineTech = {"APS" :( ("HEDM", "HEDM", "HEDM"), ("Micro-Tomography", "Micro-Tomography"), ("Micro-Tomography"),\
                        ("XPCS", "XPCS", "XPCS"), ("Nano-Tomography", "Phase Contrast Imaging"), \
                        ("High Speed Imaging and diffraction"), ("Laue Diffraction"), ("u-XFM"), ("u-XFM"),\
                        ("u-XFM"), ("u-XFM"), ("u-XFM")),
                        "ALS" :("nano-tomography", "crystallography", "crystallography", "crystallography", "crystallography", \
                                "ptychography", "PEEM", "WAXS", "crystallography", "crystallography", "crystallography", \
                                "microtomography", "crystallography", "microdiffraction"),
                    "NSLS":(),
                    "SSRL":(),
                    "LCLS":["nanocrystallography"]*7}